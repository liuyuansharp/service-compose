import { ref, computed, watch } from 'vue'

const translations = {
  zh: {
    login: '登录',
    signing_in: '正在登录...',
    dashboard_title: '工作流服务管理仪表盘',
    dashboard_subtitle: '实时监控与控制',
    login_tagline: '系统接入',
    login_feature_realtime: '实时指标与状态',
    login_feature_secure: '安全控制通道',
    login_feature_overview: '多服务统一视图',
    live_label: '在线',
    username: '用户名',
    password: '密码',
    username_placeholder: '请输入用户名',
    password_placeholder: '请输入密码',
    logout: '退出登录',
    last_updated: '最后更新',
    refresh: '刷新',
    overall_status: '总体状态',
    running: '运行中',
    abnormal: '异常',
    stopped: '已停止',
    heartbeat_failed: '心跳失败',
    heartbeat_missing: '未配置心跳地址',
    heartbeat_timeout: '心跳超时',
    heartbeat_connection_error: '心跳连接失败',
    heartbeat_invalid_url: '心跳地址无效',
    heartbeat_http_error: '心跳返回 HTTP {code}',
    heartbeat_mock_failed: '心跳模拟失败',
    active_services: '运行服务',
    cpu_usage: 'CPU 使用率',
    memory_usage: '内存使用率',
    disk_usage: '磁盘使用率',
    disk_free: '可用',
    cores: '核',
    platform: '平台',
    platform_service: '平台服务',
    platform_link: '平台',
    start: '启动',
    stop: '停止',
    restart: '重启',
    metrics: '监控',
    logs: '日志',
    status: '状态',
    uptime: '运行时间',
    last_log: '最后日志',
    no_logs_yet: '暂无日志',
    services: '服务列表',
    list_view: '列表视图',
    workflow_view: '工作流视图',
    workflow_title: '服务依赖工作流',
    workflow_subtitle: '可视化服务节点依赖关系',
    workflow_empty: '暂无依赖关系数据',
    workflow_loading: '正在加载工作流...',
    workflow_refresh: '刷新',
    workflow_load_failed: '工作流加载失败',
    workflow_topo: '拓扑布局',
    workflow_force: '力导向图',
    workflow_popout: '独立窗口',
    history: '历史',
    range_1h: '近 1 小时',
    range_6h: '近 6 小时',
    range_24h: '近 24 小时',
    range_7d: '近 7 天',
    range_30d: '近 30 天',
    range_all: '全部历史',
    loading_metrics: '正在加载监控历史',
    latest: '最新',
    memory: '内存',
    disk_io: '磁盘 IO',
    read: '读取',
    write: '写入',
    top: '顶部',
    bottom: '底部',
    resume: '继续',
    pause: '暂停',
    follow: '跟随',
    following: '正在跟随',
    search_logs: '搜索日志',
    prev: '上一条',
    next: '下一条',
    download: '下载',
    clear: '清空',
    clear_logs_title: '清空日志',
    clear_logs_confirm: '确定要清空当前日志视图吗？这将重置日志流的位置，新日志将从当前时间点开始接收。',
    clear_logs_action: '确认清空',
    clear_logs_success: '日志已清空',
    log_viewer_desc: '实时日志流与分级查看',
    log_mode_live: '实时',
    log_mode_history: '历史',
    log_mode_live_desc: '实时日志流',
    log_mode_history_desc: '历史日志查询',
    paused: '已暂停',
    streaming: '接收中',
    buffer_size: '缓冲 {count}/{max}',
    log_level_filter: '级别筛选',
    log_filter_no_match: '当前级别无匹配日志，尝试切换筛选条件',
    log_level_all: '全部',
    loading_logs: '正在加载日志',
    no_logs_available: '暂无日志',
    showing_logs: '显示 {count} 条日志',
    live_count: '实时 {count}',
    total_count: '总计 {count}',
    filtered_by: '过滤条件',
    match: '匹配',
    total_lines: '总行数 {count}',
    live_count: '当前流内: {count}',
    total_count: '历史总数: {count}',
    user: '用户',
    login_required: '请输入用户名和密码',
    login_failed: '登录失败',
    welcome_back: '欢迎回来',
    logged_out: '已退出登录',
    session_expired: '会话已过期，请重新登录',
    refresh_failed: '刷新失败',
    logs_load_failed: '加载日志失败',
    metrics_load_failed: '加载监控历史失败',
    control_failed: '操作失败',
    service_action_success: '服务{action}成功',
    download_success: '下载成功',
    download_failed: '下载失败',
    search_failed: '搜索失败',
    jump_failed: '跳转失败',
    dark_mode: '暗色模式',
    light_mode: '亮色模式',
    alert_title: '告警',
    alert_stopped_title: '服务已停止',
    alert_abnormal_title: '服务异常',
    close: '关闭',
    alert_metrics: '资源使用率过高',
    info: '信息',
    loading_info: '正在加载信息...',
    no_info: '暂无信息',
    info_failed: '获取信息失败',
    info_name: '名称',
    info_version: '版本',
    info_commit: '提交哈希',
    info_build: '构建日期',
    upload_package: '上传更新包',
    uploading: '正在上传...',
    updating: '正在更新...',
    upload_progress: '上传进度',
    update_progress: '更新进度',
    update_complete: '更新完成',
    update_failed: '更新失败',
    update_file_invalid: '仅支持上传 .tar.gz 文件',
    rollback_title: '历史回滚',
    rollback_select: '选择回滚版本',
    rollback_action: '回滚',
    rollback_success: '回滚成功',
    rollback_failed: '回滚失败',
    rollback_loading: '正在加载历史版本...',
    rollback_empty: '暂无历史版本',
    rollback_confirm_title: '确认回滚',
    rollback_confirm_message: '确定回滚到 {backup} 吗？',
    rollback_confirm_warning: '该操作会替换当前版本并重启服务，请谨慎操作。',
    rollback_confirm_cancel: '取消',
    rollback_confirm_ok: '确认回滚',
    disk_details: '磁盘详情',
    disk_details_subtitle: '系统物理磁盘列表',
    disk_device: '设备',
    disk_mount: '挂载点',
    disk_type: '类型',
    disk_total: '总容量',
    disk_io: '读写速度',
    disk_io_read: '读',
    disk_io_write: '写',
    disk_io_total_rw: '累计 读/写',
    loading_disks: '正在加载磁盘信息...',
    no_disk_data: '暂无磁盘数据',
    disk_details_failed: '获取磁盘信息失败',
    cpu_cores: 'CPU 核心',
    core_usage: '每核使用率',
    core_level: '等级',
    core_level_high: '高',
    core_level_mid: '中',
    core_level_low: '低',
    core: '核心',
    cpu_avg: '平均',
    cpu_max: '最高',
    no_core_data: '暂无核心数据',
    sysinfo_title: '系统信息',
    sysinfo_os: '操作系统',
    sysinfo_distro: '发行版',
    sysinfo_kernel: '内核',
    sysinfo_arch: '架构',
    sysinfo_glibc: 'glibc',
    sysinfo_hostname: '主机名',
    sysinfo_uptime: '运行时长',
    sysinfo_cpu: '处理器',
    sysinfo_cpu_model: '型号',
    sysinfo_cores_physical: '物理核心',
    sysinfo_cores_logical: '逻辑核心',
    sysinfo_cpu_freq: '频率',
    sysinfo_load_avg: '负载 (1/5/15m)',
    sysinfo_memory: '内存',
    sysinfo_mem_total: '总内存',
    sysinfo_swap: '交换空间',
    sysinfo_network: '网络接口',
    sysinfo_runtime: '运行环境',
    sysinfo_boot_time: '启动时间',
    terminal: '终端',
    terminal_title: '终端',
    terminal_connecting: '正在连接...',
    terminal_connected: '已连接',
    terminal_disconnected: '连接已断开',
    terminal_reconnect: '重连',
    terminal_minimize: '最小化',
    terminal_maximize: '最大化',
    terminal_restore: '还原',
    terminal_popout: '新窗口打开',
    batch_start_all: '全部启动',
    batch_stop_all: '全部停止',
    batch_start_confirm: '确定要启动以下未运行的服务吗？',
    batch_stop_confirm: '确定要停止以下运行中的服务吗？',
    batch_confirm_detail: '将操作 {count}/{total} 个服务',
    batch_no_start_targets: '所有服务均已在运行中，无需启动',
    batch_no_stop_targets: '所有服务均已停止，无需停止',
    batch_select_all: '全选',
    batch_deselect_all: '取消全选',
    confirm_yes: '确认',
    confirm_no: '取消',
    batch_action_success: '批量{action}操作已执行',
    batch_action_failed: '批量{action}操作失败',
    batch_result_failed: '个失败',
    batch_result_skipped: '个被跳过(操作中)',
    service_busy: '该服务正在被其他用户操作，请稍后再试',
    role_admin: '管理员',
    role_operator: '操作员',
    role_readonly: '只读',
    role: '角色',
    user_management: '用户管理',
    user_management_desc: '管理用户角色和可见卡片权限',
    add_user: '新增用户',
    add: '添加',
    actions: '操作',
    created_at: '创建时间',
    visible_cards_label: '可见卡片',
    visible_cards_all: '全部可见',
    visible_cards_custom: '已选 {count} 项',
    visible_cards_title: '{user} - 可见卡片配置',
    visible_cards_hint: '不勾选任何项表示全部可见；勾选后仅显示选中的卡片。',
    visible_cards_select_all: '全部可见（清空选择）',
    card_overview: '总体状态',
    card_overview_desc: '运行状态、活跃服务数、系统指标',
    card_platform: '平台服务',
    card_platform_desc: '平台服务卡片及控制',
    card_service_desc: '{name} 服务卡片',
    current_user_tag: '当前',
    reset_password: '重置密码',
    reset_password_title: '{user} - 重置密码',
    new_password: '新密码',
    confirm: '确认',
    cancel: '取消',
    save: '保存',
    delete: '删除',
    user_created: '用户创建成功',
    user_updated: '用户更新成功',
    user_deleted: '用户已删除',
    password_reset_success: '密码重置成功',
    delete_user_confirm: '确定要删除用户 {user} 吗？',
    permission_denied: '权限不足',
    audit_log: '操作日志',
    audit_log_desc: '记录所有用户操作历史',
    audit_col_time: '时间',
    audit_col_user: '用户',
    audit_col_role: '角色',
    audit_col_action: '操作',
    audit_col_target: '目标',
    audit_col_detail: '详情',
    audit_col_result: '结果',
    audit_result_success: '成功',
    audit_result_failed: '失败',
    audit_action_login: '登录',
    audit_action_start: '启动',
    audit_action_stop: '停止',
    audit_action_restart: '重启',
    audit_action_upload: '上传',
    audit_action_rollback: '回滚',
    audit_action_create_user: '创建用户',
    audit_action_update_user: '更新用户',
    audit_action_delete_user: '删除用户',
    audit_action_batch_start: '批量启动',
    audit_action_batch_stop: '批量停止',
    audit_filter_all_actions: '全部操作',
    audit_total: '共 {count} 条',
    audit_own_only: '仅显示本人操作',
    audit_empty: '暂无操作记录',
    audit_prev: '上一页',
    audit_next: '下一页',
    role_unknown: '未知',
    sched_title: '定时重启',
    sched_time: '重启时间',
    sched_weekdays: '重启日期',
    sched_weekdays_hint: '不选则每天执行',
    sched_save: '保存定时设置',
    sched_saved: '定时重启设置已保存',
    sched_next: '下次重启',
    sched_last: '上次重启',
    sched_disabled: '未启用定时重启',
    sched_enabled_label: '已启用',
    sched_cron_label: '计划',
    audit_action_update_schedule: '定时设置',
    trend: '趋势',
    cpu_trend_title: 'CPU 使用率趋势',
    mem_trend_title: '内存使用率趋势',
    trend_no_data: '暂无趋势数据，系统每分钟采集一次',
    trend_points: '共 {count} 个数据点',
    pid_tree: '进程树',
    pid_tree_title: '{service} 进程树',
    pid_tree_desc: '查看父子进程关系及资源消耗',
    pid_tree_loading: '正在加载进程树...',
    pid_tree_empty: '未找到进程（服务可能未运行）',
    pid_tree_root: '根进程',
    pid_tree_child: '子进程',
    pid_tree_cmd: '完整命令',
    pid_tree_threads: '线程数',
    pid_tree_created: '启动时间',
    pid_tree_uptime: '运行时长',
    pid_tree_status: '状态',
    pid_tree_kill: '终止',
    pid_tree_kill_all: '终止全部',
    pid_tree_kill_confirm: '确定终止 PID {pid} 吗？',
    pid_tree_kill_all_confirm: '确定终止该服务的全部 {count} 个进程吗？此操作不可撤销。',
    pid_tree_killed: '已终止进程',
    pid_tree_total: '共 {count} 个进程',
    pid_tree_read: '读',
    pid_tree_write: '写',
    pid_tree_refresh: '刷新',
  },
  en: {
    login: 'Login',
    signing_in: 'Signing in...',
    dashboard_title: 'Workflow Service Manager Dashboard',
    dashboard_subtitle: 'Real-time monitoring and control',
    login_tagline: 'System Access',
    login_feature_realtime: 'Realtime metrics & status',
    login_feature_secure: 'Secure control access',
    login_feature_overview: 'Multi-service overview',
    live_label: 'Live',
    username: 'Username',
    password: 'Password',
    username_placeholder: 'Enter username',
    password_placeholder: 'Enter password',
    logout: 'Logout',
    last_updated: 'Last updated',
    refresh: 'Refresh',
    overall_status: 'Overall Status',
    running: 'Running',
    abnormal: 'Abnormal',
    stopped: 'Stopped',
    heartbeat_failed: 'Heartbeat failed',
    heartbeat_missing: 'Heartbeat URL missing',
    heartbeat_timeout: 'Heartbeat timeout',
    heartbeat_connection_error: 'Heartbeat connection error',
    heartbeat_invalid_url: 'Heartbeat URL invalid',
    heartbeat_http_error: 'Heartbeat returned HTTP {code}',
    heartbeat_mock_failed: 'Heartbeat mock failed',
    active_services: 'Active Services',
    cpu_usage: 'CPU Usage',
    memory_usage: 'Memory Usage',
    disk_usage: 'Disk Usage',
    disk_free: 'Free',
    cores: 'cores',
    platform: 'Platform',
    platform_service: 'Platform service',
    platform_link: 'Platform',
    start: 'Start',
    stop: 'Stop',
    restart: 'Restart',
    metrics: 'Metrics',
    logs: 'Logs',
    status: 'Status',
    uptime: 'Uptime',
    last_log: 'Last Log',
    no_logs_yet: 'No logs yet',
    services: 'Services',
    list_view: 'List view',
    workflow_view: 'Workflow view',
    workflow_title: 'Service Dependency Workflow',
    workflow_subtitle: 'Visualize dependency relationships',
    workflow_empty: 'No dependency data available',
    workflow_loading: 'Loading workflow...',
    workflow_refresh: 'Refresh',
    workflow_load_failed: 'Failed to load workflow',
    workflow_topo: 'Topology',
    workflow_force: 'Force Graph',
    workflow_popout: 'Pop out',
    history: 'History',
    range_1h: 'Last 1h',
    range_6h: 'Last 6h',
    range_24h: 'Last 24h',
    range_7d: 'Last 7d',
    range_30d: 'Last 30d',
    range_all: 'All history',
    loading_metrics: 'Loading metrics history',
    latest: 'Latest',
    memory: 'Memory',
    disk_io: 'Disk IO',
    read: 'Read',
    write: 'Write',
    top: 'Top',
    bottom: 'Bottom',
    resume: 'Resume',
    pause: 'Pause',
    follow: 'Follow',
    following: 'Following',
    search_logs: 'Search logs',
    prev: 'Prev',
    next: 'Next',
    download: 'Download',
    clear: 'Clear',
    clear_logs_title: 'Clear Logs',
    clear_logs_confirm: 'Clear the current log view? The log stream position will be reset and new logs will be received from the current point.',
    clear_logs_action: 'Clear',
    clear_logs_success: 'Logs cleared',
    log_viewer_desc: 'Real-time log streaming with level filtering',
    log_mode_live: 'Live',
    log_mode_history: 'History',
    log_mode_live_desc: 'Real-time log streaming',
    log_mode_history_desc: 'Historical log browsing',
    paused: 'Paused',
    streaming: 'Streaming',
    buffer_size: 'Buffer {count}/{max}',
    log_level_filter: 'Level filter',
    log_filter_no_match: 'No logs match the current filter. Try switching levels.',
    log_level_all: 'All',
    loading_logs: 'Loading logs',
    no_logs_available: 'No logs available',
    showing_logs: 'Showing {count} logs',
    live_count: 'Live {count}',
    total_count: 'Total {count}',
    filtered_by: 'filtered by',
    match: 'Match',
    total_lines: 'Total {count} lines',
    live_count: 'Live: {count}',
    total_count: 'Total: {count}',
    user: 'User',
    login_required: 'Username and password are required',
    login_failed: 'Login failed',
    welcome_back: 'Welcome back!',
    logged_out: 'Logged out successfully',
    session_expired: 'Session expired. Please log in again.',
    refresh_failed: 'Failed to refresh status',
    logs_load_failed: 'Failed to load logs',
    metrics_load_failed: 'Failed to load metrics history',
    control_failed: 'Service control failed',
    service_action_success: 'Service {action}ed successfully',
    download_success: 'Download completed',
    download_failed: 'Download failed',
    search_failed: 'Failed to search logs',
    jump_failed: 'Failed to jump',
    dark_mode: 'Dark mode',
    light_mode: 'Light mode',
    alert_title: 'Alert',
    alert_stopped_title: 'Service stopped',
    alert_abnormal_title: 'Service abnormal',
    close: 'Close',
    alert_metrics: 'High resource usage',
    info: 'Info',
    loading_info: 'Loading info...',
    no_info: 'No info',
    info_failed: 'Failed to load info',
    info_name: 'Name',
    info_version: 'Version',
    info_commit: 'Commit hash',
    info_build: 'Build date',
    upload_package: 'Upload package',
    uploading: 'Uploading...',
    updating: 'Updating...',
    upload_progress: 'Upload progress',
    update_progress: 'Update progress',
    update_complete: 'Update completed',
    update_failed: 'Update failed',
    update_file_invalid: 'Only .tar.gz files are supported',
    rollback_title: 'Rollback history',
    rollback_select: 'Select backup',
    rollback_action: 'Rollback',
    rollback_success: 'Rollback completed',
    rollback_failed: 'Rollback failed',
    rollback_loading: 'Loading backups...',
    rollback_empty: 'No backups available',
    rollback_confirm_title: 'Confirm rollback',
    rollback_confirm_message: 'Rollback to {backup}?',
    rollback_confirm_warning: 'This will replace the current version and restart the service.',
    rollback_confirm_cancel: 'Cancel',
    rollback_confirm_ok: 'Confirm rollback',
    disk_details: 'Disk details',
    disk_details_subtitle: 'Physical disks on this host',
    disk_device: 'Device',
    disk_mount: 'Mount',
    disk_type: 'Type',
    disk_total: 'Total',
    disk_io: 'I/O Speed',
    disk_io_read: 'R',
    disk_io_write: 'W',
    disk_io_total_rw: 'Total R/W',
    loading_disks: 'Loading disk info...',
    no_disk_data: 'No disk data',
    disk_details_failed: 'Failed to load disk info',
    cpu_cores: 'CPU Cores',
    core_usage: 'Per-core usage',
    core_level: 'Level',
    core_level_high: 'High',
    core_level_mid: 'Medium',
    core_level_low: 'Low',
    core: 'Core',
    cpu_avg: 'Avg',
    cpu_max: 'Max',
    no_core_data: 'No core data',
    sysinfo_title: 'System Information',
    sysinfo_os: 'Operating System',
    sysinfo_distro: 'Distribution',
    sysinfo_kernel: 'Kernel',
    sysinfo_arch: 'Architecture',
    sysinfo_glibc: 'glibc',
    sysinfo_hostname: 'Hostname',
    sysinfo_uptime: 'Uptime',
    sysinfo_cpu: 'Processor',
    sysinfo_cpu_model: 'Model',
    sysinfo_cores_physical: 'Physical Cores',
    sysinfo_cores_logical: 'Logical Cores',
    sysinfo_cpu_freq: 'Frequency',
    sysinfo_load_avg: 'Load (1/5/15m)',
    sysinfo_memory: 'Memory',
    sysinfo_mem_total: 'Total Memory',
    sysinfo_swap: 'Swap',
    sysinfo_network: 'Network Interfaces',
    sysinfo_runtime: 'Runtime',
    sysinfo_boot_time: 'Boot Time',
    terminal: 'Terminal',
    terminal_title: 'Terminal',
    terminal_connecting: 'Connecting...',
    terminal_connected: 'Connected',
    terminal_disconnected: 'Disconnected',
    terminal_reconnect: 'Reconnect',
    terminal_minimize: 'Minimize',
    terminal_maximize: 'Maximize',
    terminal_restore: 'Restore',
    terminal_popout: 'Pop out',
    batch_start_all: 'Start All',
    batch_stop_all: 'Stop All',
    batch_start_confirm: 'Start the following stopped services?',
    batch_stop_confirm: 'Stop the following running services?',
    batch_confirm_detail: 'Will affect {count}/{total} services',
    batch_no_start_targets: 'All services are already running',
    batch_no_stop_targets: 'All services are already stopped',
    batch_select_all: 'Select All',
    batch_deselect_all: 'Deselect All',
    confirm_yes: 'Confirm',
    confirm_no: 'Cancel',
    batch_action_success: 'Batch {action} executed successfully',
    batch_action_failed: 'Batch {action} failed',
    batch_result_failed: 'failed',
    batch_result_skipped: 'skipped (busy)',
    service_busy: 'Service is being operated by another user, please try again later',
    role_admin: 'Admin',
    role_operator: 'Operator',
    role_readonly: 'Read-only',
    role: 'Role',
    user_management: 'Users',
    user_management_desc: 'Manage user roles and card visibility',
    add_user: 'Add User',
    add: 'Add',
    actions: 'Actions',
    created_at: 'Created',
    visible_cards_label: 'Visible Cards',
    visible_cards_all: 'All visible',
    visible_cards_custom: '{count} selected',
    visible_cards_title: '{user} - Visible Cards',
    visible_cards_hint: 'Leave all unchecked to show everything; check items to show only selected cards.',
    visible_cards_select_all: 'Show all (clear selection)',
    card_overview: 'Overview',
    card_overview_desc: 'Status, active services, system metrics',
    card_platform: 'Platform Service',
    card_platform_desc: 'Platform service card and controls',
    card_service_desc: '{name} service card',
    current_user_tag: 'You',
    reset_password: 'Reset Password',
    reset_password_title: '{user} - Reset Password',
    new_password: 'New password',
    confirm: 'Confirm',
    cancel: 'Cancel',
    save: 'Save',
    delete: 'Delete',
    user_created: 'User created',
    user_updated: 'User updated',
    user_deleted: 'User deleted',
    password_reset_success: 'Password reset successfully',
    delete_user_confirm: 'Are you sure you want to delete user {user}?',
    permission_denied: 'Permission denied',
    audit_log: 'Operation Log',
    audit_log_desc: 'History of all user operations',
    audit_col_time: 'Time',
    audit_col_user: 'User',
    audit_col_role: 'Role',
    audit_col_action: 'Action',
    audit_col_target: 'Target',
    audit_col_detail: 'Detail',
    audit_col_result: 'Result',
    audit_result_success: 'Success',
    audit_result_failed: 'Failed',
    audit_action_login: 'Login',
    audit_action_start: 'Start',
    audit_action_stop: 'Stop',
    audit_action_restart: 'Restart',
    audit_action_upload: 'Upload',
    audit_action_rollback: 'Rollback',
    audit_action_create_user: 'Create User',
    audit_action_update_user: 'Update User',
    audit_action_delete_user: 'Delete User',
    audit_action_batch_start: 'Batch Start',
    audit_action_batch_stop: 'Batch Stop',
    audit_filter_all_actions: 'All Actions',
    audit_total: '{count} records',
    audit_own_only: 'Showing own records only',
    audit_empty: 'No operation records',
    audit_prev: 'Previous',
    audit_next: 'Next',
    role_unknown: 'Unknown',
    sched_title: 'Scheduled Restart',
    sched_time: 'Restart Time',
    sched_weekdays: 'Restart Days',
    sched_weekdays_hint: 'Leave empty for daily',
    sched_save: 'Save Schedule',
    sched_saved: 'Scheduled restart saved',
    sched_next: 'Next Restart',
    sched_last: 'Last Restart',
    sched_disabled: 'Scheduled restart not enabled',
    sched_enabled_label: 'Enabled',
    sched_cron_label: 'Schedule',
    audit_action_update_schedule: 'Schedule Update',
    trend: 'Trend',
    cpu_trend_title: 'CPU Usage Trend',
    mem_trend_title: 'Memory Usage Trend',
    range_1h: 'Last 1h',
    range_6h: 'Last 6h',
    range_24h: 'Last 24h',
    range_7d: 'Last 7d',
    range_30d: 'Last 30d',
    range_all: 'All History',
    trend_no_data: 'No trend data yet. System samples every minute.',
    trend_points: '{count} data points',
    pid_tree: 'Process Tree',
    pid_tree_title: '{service} Process Tree',
    pid_tree_desc: 'View parent-child process relationships and resource usage',
    pid_tree_loading: 'Loading process tree...',
    pid_tree_empty: 'No processes found (service may not be running)',
    pid_tree_root: 'Root',
    pid_tree_child: 'Child',
    pid_tree_cmd: 'Full Command',
    pid_tree_threads: 'Threads',
    pid_tree_created: 'Started',
    pid_tree_uptime: 'Uptime',
    pid_tree_status: 'Status',
    pid_tree_kill: 'Kill',
    pid_tree_kill_all: 'Kill All',
    pid_tree_kill_confirm: 'Are you sure you want to kill PID {pid}?',
    pid_tree_kill_all_confirm: 'Are you sure you want to kill all {count} processes? This cannot be undone.',
    pid_tree_killed: 'Process terminated',
    pid_tree_total: '{count} processes total',
    pid_tree_read: 'Read',
    pid_tree_write: 'Write',
    pid_tree_refresh: 'Refresh',
  }
}

export function useI18n() {
  const lang = ref(localStorage.getItem('lang') || 'zh')

  const t = (key, vars = {}) => {
    let text = translations[lang.value]?.[key] || key
    Object.entries(vars).forEach(([k, v]) => {
      text = text.replace(new RegExp(`\\{${k}\\}`, 'g'), v)
    })
    return text
  }

  const updateDocumentMeta = () => {
    const title = t('dashboard_title')
    if (typeof document !== 'undefined') {
      document.title = title
      const langValue = lang.value === 'zh' ? 'zh-CN' : 'en'
      document.documentElement.lang = langValue
    }
  }

  watch(lang, () => {
    updateDocumentMeta()
    localStorage.setItem('lang', lang.value)
  }, { immediate: true })

  const langLabel = computed(() => (lang.value === 'zh' ? 'EN' : '中文'))

  const toggleLanguage = () => {
    lang.value = lang.value === 'zh' ? 'en' : 'zh'
  }

  return {
    lang,
    translations,
    t,
    langLabel,
    toggleLanguage,
    updateDocumentMeta,
  }
}
