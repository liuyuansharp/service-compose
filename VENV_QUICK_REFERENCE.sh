#!/bin/bash

# è™šæ‹Ÿç¯å¢ƒå¿«é€Ÿä½¿ç”¨æŒ‡å—
# å¯ä»¥ç›´æ¥å¤åˆ¶ç²˜è´´ä¸‹é¢çš„å‘½ä»¤

# =============================================================================
# ğŸ“– è™šæ‹Ÿç¯å¢ƒå¿«é€Ÿå‘½ä»¤
# =============================================================================

# 1ï¸âƒ£  æ¿€æ´»è™šæ‹Ÿç¯å¢ƒï¼ˆå¿…é¡»é¦–å…ˆè¿è¡Œï¼‰
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
cd /home/liuyuan/workspace/work/fsys/service
source venv/bin/activate
# æˆåŠŸåæç¤ºç¬¦ä¼šæ˜¾ç¤º (venv) å‰ç¼€


# 2ï¸âƒ£  éªŒè¯è™šæ‹Ÿç¯å¢ƒ
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# æŸ¥çœ‹ Python è·¯å¾„ï¼ˆåº”è¯¥æŒ‡å‘ venv/bin/pythonï¼‰
which python

# æŸ¥çœ‹ Python ç‰ˆæœ¬
python --version

# æŸ¥çœ‹å·²å®‰è£…çš„åŒ…
pip list


# 3ï¸âƒ£  è¿è¡Œåç«¯åº”ç”¨
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# åŸºæœ¬å¯åŠ¨
python dashboard_api.py

# æŒ‡å®šä¸»æœºå’Œç«¯å£
python dashboard_api.py --host 0.0.0.0 --port 8080

# æŸ¥çœ‹æ—¥å¿—
python dashboard_api.py --host 0.0.0.0 --port 8080 2>&1 | tee backend.log


# 4ï¸âƒ£  è¿è¡Œå‰ç«¯åº”ç”¨
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
cd frontend

# å¼€å‘æ¨¡å¼ï¼ˆè‡ªåŠ¨çƒ­åŠ è½½ï¼‰
npm run dev

# ç”Ÿäº§æ„å»º
npm run build


# 5ï¸âƒ£  å®‰è£…æ–°çš„ä¾èµ–åŒ…
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# å®‰è£…å•ä¸ªåŒ…
pip install requests

# å®‰è£…å¤šä¸ªåŒ…
pip install requests flask

# ä» requirements.txt å®‰è£…
pip install -r requirements.txt

# å‡çº§åŒ…
pip install --upgrade fastapi


# 6ï¸âƒ£  ç®¡ç†ä¾èµ–
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ç”Ÿæˆæ–°çš„ requirements.txtï¼ˆå¦‚æœå®‰è£…äº†æ–°åŒ…ï¼‰
pip freeze > requirements.txt

# æ£€æŸ¥å“ªäº›åŒ…å¯ä»¥å‡çº§
pip list --outdated

# æ£€æŸ¥å•ä¸ªåŒ…çš„ä¿¡æ¯
pip show fastapi


# 7ï¸âƒ£  åœç”¨è™šæ‹Ÿç¯å¢ƒ
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
deactivate
# æç¤ºç¬¦ä¼šæ¢å¤ä¸ºæ­£å¸¸çŠ¶æ€


# 8ï¸âƒ£  é‡æ–°åˆ›å»ºè™šæ‹Ÿç¯å¢ƒï¼ˆå¦‚æœå‡ºé—®é¢˜ï¼‰
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# åˆ é™¤æ—§çš„è™šæ‹Ÿç¯å¢ƒ
rm -rf venv

# åˆ›å»ºæ–°çš„è™šæ‹Ÿç¯å¢ƒ
python3 -m venv venv

# æ¿€æ´»
source venv/bin/activate

# å®‰è£…ä¾èµ–
pip install -r requirements.txt


# =============================================================================
# ğŸ¯ å¸¸ç”¨ä¸€é”®å‘½ä»¤
# =============================================================================

# ä¸€é”®å¯åŠ¨åç«¯ï¼ˆæ¿€æ´» + è¿è¡Œï¼‰
cd /home/liuyuan/workspace/work/fsys/service && source venv/bin/activate && python dashboard_api.py --port 8080

# ä¸€é”®æ£€æŸ¥è™šæ‹Ÿç¯å¢ƒ
cd /home/liuyuan/workspace/work/fsys/service && source venv/bin/activate && python --version && pip list | head -5

# ä¸€é”®ç”Ÿæˆä¾èµ–
cd /home/liuyuan/workspace/work/fsys/service && source venv/bin/activate && pip freeze > requirements.txt

# ä¸€é”®é‡å»ºè™šæ‹Ÿç¯å¢ƒå’Œä¾èµ–
cd /home/liuyuan/workspace/work/fsys/service && rm -rf venv && python3 -m venv venv && source venv/bin/activate && pip install -r requirements.txt


# =============================================================================
# ğŸ“Š è™šæ‹Ÿç¯å¢ƒç»“æ„
# =============================================================================

# venv/
# â”œâ”€â”€ bin/                           <- å¯æ‰§è¡Œæ–‡ä»¶
# â”‚   â”œâ”€â”€ activate                   <- æ¿€æ´»è„šæœ¬ï¼ˆbashï¼‰
# â”‚   â”œâ”€â”€ activate.csh               <- æ¿€æ´»è„šæœ¬ï¼ˆcshï¼‰
# â”‚   â”œâ”€â”€ python                     <- Python è§£é‡Šå™¨
# â”‚   â”œâ”€â”€ pip                        <- pip åŒ…ç®¡ç†å™¨
# â”‚   â””â”€â”€ ...
# â”œâ”€â”€ lib/
# â”‚   â””â”€â”€ python3.12/
# â”‚       â””â”€â”€ site-packages/         <- å·²å®‰è£…çš„åŒ…
# â”œâ”€â”€ include/                       <- C å¤´æ–‡ä»¶
# â””â”€â”€ pyvenv.cfg                     <- é…ç½®æ–‡ä»¶


# =============================================================================
# âœ… æ£€æŸ¥æ¸…å•
# =============================================================================

# [ ] è™šæ‹Ÿç¯å¢ƒå·²åˆ›å»ºï¼švenv/bin/activate å­˜åœ¨
# [ ] è™šæ‹Ÿç¯å¢ƒå·²æ¿€æ´»ï¼šæç¤ºç¬¦æ˜¾ç¤º (venv)
# [ ] Python ç‰ˆæœ¬æ­£ç¡®ï¼š3.12.7
# [ ] æ‰€æœ‰ä¾èµ–å·²å®‰è£…ï¼š6 ä¸ªåŒ…ï¼ˆfastapi, uvicorn, pydantic ç­‰ï¼‰
# [ ] åç«¯å¯ä»¥è¿è¡Œï¼špython dashboard_api.py --port 8080
# [ ] å‰ç«¯å¯ä»¥è¿è¡Œï¼šcd frontend && npm run dev
# [ ] API å¯è®¿é—®ï¼šhttp://localhost:8080/api/docs


# =============================================================================
# ğŸ”— ç›¸å…³æ–‡æ¡£
# =============================================================================

# è¯¦ç»†è®¾ç½®æŒ‡å—ï¼šVENV_SETUP.md
# é¡¹ç›®æ¦‚è¿°ï¼šREADME.md
# å¿«é€Ÿå¼€å§‹ï¼šQUICK_START.md
# API æ–‡æ¡£ï¼šhttp://localhost:8080/api/docs
